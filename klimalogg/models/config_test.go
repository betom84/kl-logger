package models_test

import (
	"testing"

	"github.com/betom84/kl-logger/klimalogg/models"
	"github.com/stretchr/testify/assert"
)

var configExampleData = []byte{0x64, 0x5c, 0x00, 0x05, 0x99, 0x90, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x80, 0x04, 0x00, 0x99, 0x99, 0x70, 0x20, 0x70, 0x20, 0x70, 0x20, 0x70, 0x20, 0x70, 0x20, 0x70, 0x20, 0x70, 0x20, 0x70, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x1b, 0x53, 0x8c}

func TestUnmarshalConfigData(t *testing.T) {
	model := models.ConfigResponseData{}

	err := model.UnmarshalBinary(configExampleData)
	assert.NoError(t, err)

	assert.Equal(t, 6995, model.CfgChecksum)
	assert.Equal(t, 5, model.Settings.Contrast)
	assert.Equal(t, false, model.Settings.Alert)
	assert.Equal(t, true, model.Settings.DCF)
	assert.Equal(t, "24h", model.Settings.TimeFormat)
	assert.Equal(t, "Celcius", model.Settings.TempFormat)
}
